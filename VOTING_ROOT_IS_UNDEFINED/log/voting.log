2016-08-11 18:15:39,783 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:15:39,804 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:15:39,808 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@78186a70, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee, org.springframework.test.context.support.DirtiesContextTestExecutionListener@545997b1, org.springframework.test.context.transaction.TransactionalTestExecutionListener@4cf4d528, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@77846d2c]
2016-08-11 18:15:39,982 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:15:40,297 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:15:40,405 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@276438c9: startup date [Thu Aug 11 18:15:40 MSK 2016]; root of context hierarchy
2016-08-11 18:15:40,521 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:15:40,770 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:15:40,787 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:40,826 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:15:40,963 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:15:40,965 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:15:40,967 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:15:41,036 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:15:41,427 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:15:41,731 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:15:41,735 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@61861a29
2016-08-11 18:15:42,412 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:15:43,054 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:15:43,334 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:15:43,361 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:15:43,362 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:43,366 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@42b28ff1]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:15:43,384 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:15:43,440 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:15:43,490 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@6629ad09: startup date [Thu Aug 11 18:15:43 MSK 2016]; root of context hierarchy
2016-08-11 18:15:43,509 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:15:43,527 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:15:43,543 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:43,544 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:15:43,608 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:15:43,804 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:15:43,806 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@61861a29
2016-08-11 18:15:43,856 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:15:43,935 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:15:43,939 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:15:43,939 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:43,941 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@445bb139]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:15:43,953 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:15:43,991 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:15:44,020 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@2d64160c: startup date [Thu Aug 11 18:15:44 MSK 2016]; root of context hierarchy
2016-08-11 18:15:44,038 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:15:44,062 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:15:44,070 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:44,071 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:15:44,117 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:15:44,345 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:15:44,346 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@61861a29
2016-08-11 18:15:44,387 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:15:44,457 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:15:44,461 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:15:44,461 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:44,463 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@561953e3]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:15:44,476 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:15:44,517 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:15:44,549 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@64920dc2: startup date [Thu Aug 11 18:15:44 MSK 2016]; root of context hierarchy
2016-08-11 18:15:44,564 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:15:44,580 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:15:44,588 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:44,588 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:15:44,628 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:15:44,761 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:15:44,762 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@61861a29
2016-08-11 18:15:44,821 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:15:44,881 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:15:44,887 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:15:44,887 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:15:44,889 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@318c68d5]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:17:25,150 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:17:25,171 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:17:25,175 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@78186a70, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee, org.springframework.test.context.support.DirtiesContextTestExecutionListener@545997b1, org.springframework.test.context.transaction.TransactionalTestExecutionListener@4cf4d528, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@77846d2c]
2016-08-11 18:17:25,320 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:17:25,583 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:17:25,700 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@276438c9: startup date [Thu Aug 11 18:17:25 MSK 2016]; root of context hierarchy
2016-08-11 18:17:25,857 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:17:26,158 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:17:26,210 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:26,240 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:17:26,421 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:17:26,426 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:17:26,429 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:17:26,517 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:17:26,938 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:17:27,180 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:17:27,183 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@3f23a3a0
2016-08-11 18:17:27,672 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:17:28,137 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:17:28,408 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:17:28,417 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:17:28,418 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:28,423 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@66420549]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:17:28,437 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:17:28,479 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:17:28,515 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@4c18621b: startup date [Thu Aug 11 18:17:28 MSK 2016]; root of context hierarchy
2016-08-11 18:17:28,533 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:17:28,548 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:17:28,557 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:28,557 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:17:28,592 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:17:28,783 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:17:28,784 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@3f23a3a0
2016-08-11 18:17:28,832 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:17:28,905 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:17:28,909 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:17:28,909 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:28,910 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@5db6b845]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:17:28,920 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:17:28,955 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:17:29,022 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@b9a77c8: startup date [Thu Aug 11 18:17:29 MSK 2016]; root of context hierarchy
2016-08-11 18:17:29,047 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:17:29,063 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:17:29,076 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:29,077 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:17:29,117 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:17:29,288 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:17:29,289 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@3f23a3a0
2016-08-11 18:17:29,337 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:17:29,413 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:17:29,419 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:17:29,419 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:29,420 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@794366a5]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:17:29,431 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:17:29,477 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:17:29,516 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@443faa85: startup date [Thu Aug 11 18:17:29 MSK 2016]; root of context hierarchy
2016-08-11 18:17:29,531 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:17:29,546 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:17:29,553 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:29,554 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:17:29,591 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:17:29,770 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:17:29,771 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@3f23a3a0
2016-08-11 18:17:29,814 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:17:29,878 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:17:29,883 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:17:29,884 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:17:29,885 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@306279ee] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@7e91ed74]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:18:41,112 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:18:41,134 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:18:41,135 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@6ec8211c, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@7276c8cd, org.springframework.test.context.support.DirtiesContextTestExecutionListener@544a2ea6, org.springframework.test.context.transaction.TransactionalTestExecutionListener@2e3fc542, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@150c158]
2016-08-11 18:18:41,251 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:18:41,500 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:18:41,600 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@60438a68: startup date [Thu Aug 11 18:18:41 MSK 2016]; root of context hierarchy
2016-08-11 18:18:41,745 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:18:41,975 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:18:42,007 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:42,080 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:18:42,234 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:18:42,237 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:18:42,239 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:18:42,332 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:18:42,773 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:18:42,991 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:18:42,995 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@841e575
2016-08-11 18:18:43,472 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:18:43,969 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:18:44,217 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:18:44,224 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:18:44,225 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:44,228 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@7276c8cd] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@481e91b6]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:18:44,240 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:18:44,277 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:18:44,317 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@66420549: startup date [Thu Aug 11 18:18:44 MSK 2016]; root of context hierarchy
2016-08-11 18:18:44,339 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:18:44,353 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:18:44,361 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:44,361 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:18:44,399 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:18:44,561 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:18:44,562 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@841e575
2016-08-11 18:18:44,621 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:18:44,724 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:18:44,728 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:18:44,729 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:44,730 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@7276c8cd] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@1e9469b8]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:18:44,737 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:18:44,811 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:18:44,874 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@79e66b2f: startup date [Thu Aug 11 18:18:44 MSK 2016]; root of context hierarchy
2016-08-11 18:18:44,899 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:18:44,925 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:18:44,953 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:44,954 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:18:45,021 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:18:45,193 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:18:45,194 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@841e575
2016-08-11 18:18:45,247 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:18:45,318 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:18:45,324 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:18:45,325 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:45,326 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@7276c8cd] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@46f902e0]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:18:45,339 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:18:45,379 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:18:45,410 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@7165d530: startup date [Thu Aug 11 18:18:45 MSK 2016]; root of context hierarchy
2016-08-11 18:18:45,426 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:18:45,450 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:18:45,460 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:45,461 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:18:45,506 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:18:45,659 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:18:45,660 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@841e575
2016-08-11 18:18:45,709 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:18:45,755 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:18:45,758 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:18:45,759 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:18:45,760 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@7276c8cd] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@78fe204a]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:19:33,876 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:19:33,896 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:19:33,899 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@71248c21, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@442675e1, org.springframework.test.context.support.DirtiesContextTestExecutionListener@6166e06f, org.springframework.test.context.transaction.TransactionalTestExecutionListener@49e202ad, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@1c72da34]
2016-08-11 18:19:33,979 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:19:34,141 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:19:34,234 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@4206a205: startup date [Thu Aug 11 18:19:34 MSK 2016]; root of context hierarchy
2016-08-11 18:19:34,331 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:19:34,486 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:19:34,501 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:34,522 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:19:34,603 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:19:34,605 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:19:34,608 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:19:34,652 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:19:34,909 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:19:35,150 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:19:35,153 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@114a85c2
2016-08-11 18:19:35,603 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:19:36,075 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:19:36,312 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:19:36,324 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:19:36,325 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:36,329 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@442675e1] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@278667fd]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:367)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 26 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 48 common frames omitted
2016-08-11 18:19:36,337 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:19:36,396 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:19:36,435 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@10823d72: startup date [Thu Aug 11 18:19:36 MSK 2016]; root of context hierarchy
2016-08-11 18:19:36,454 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:19:36,468 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:19:36,480 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:36,482 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:19:36,521 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:19:36,671 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:19:36,672 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@114a85c2
2016-08-11 18:19:36,716 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:19:36,793 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:19:36,797 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:19:36,798 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:36,800 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@442675e1] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@5ad5be4a]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:367)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 26 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 48 common frames omitted
2016-08-11 18:19:36,803 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:19:36,837 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:19:36,869 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@3ad85136: startup date [Thu Aug 11 18:19:36 MSK 2016]; root of context hierarchy
2016-08-11 18:19:36,884 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:19:36,898 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:19:36,907 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:36,908 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:19:36,940 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:19:37,084 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:19:37,085 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@114a85c2
2016-08-11 18:19:37,134 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:19:37,184 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:19:37,187 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:19:37,188 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:37,189 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@442675e1] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@7377781e]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:367)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 26 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 48 common frames omitted
2016-08-11 18:19:37,193 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:19:37,226 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:19:37,251 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@31db34da: startup date [Thu Aug 11 18:19:37 MSK 2016]; root of context hierarchy
2016-08-11 18:19:37,264 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:19:37,277 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:19:37,285 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:37,286 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:19:37,339 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:19:37,454 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:19:37,454 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@114a85c2
2016-08-11 18:19:37,501 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:19:37,556 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:19:37,561 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:19:37,562 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:19:37,563 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@442675e1] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@235b4cb8]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:367)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 26 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 48 common frames omitted
2016-08-11 18:23:24,337 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:23:24,358 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:23:24,360 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:23:24,540 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:23:24,736 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:23:24,846 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:23:24 MSK 2016]; root of context hierarchy
2016-08-11 18:23:24,981 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:23:25,423 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:23:25,444 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:23:25,484 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:23:25,657 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:23:25,660 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:23:25,663 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:23:25,745 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:23:26,253 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:23:26,484 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:23:26,487 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@4ef27d66
2016-08-11 18:23:26,936 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:23:27,465 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:23:27,724 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:23:27,733 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:23:27,734 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:23:27,738 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@5a2bd7c8]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:27:25,035 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:27:25,046 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:27:25,056 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@6c3f5566, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@12405818, org.springframework.test.context.support.DirtiesContextTestExecutionListener@314c508a, org.springframework.test.context.transaction.TransactionalTestExecutionListener@10b48321, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@6b67034]
2016-08-11 18:27:25,137 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:27:25,302 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:27:25,383 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@2b4a2ec7: startup date [Thu Aug 11 18:27:25 MSK 2016]; root of context hierarchy
2016-08-11 18:27:25,480 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:27:25,661 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:27:25,678 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:27:25,699 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:27:25,781 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:27:25,784 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:27:25,786 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:27:25,830 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:27:26,100 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:27:26,330 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:27:26,332 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@66971f6b
2016-08-11 18:27:26,793 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:27:27,264 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:27:27,546 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/initDB.sql]
2016-08-11 18:27:27,558 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #4 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
2016-08-11 18:27:27,559 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:27:27,563 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@12405818] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@158f4cfe]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:367)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #4 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 26 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #4 of class path resource [db/initDB.sql]: DROP TABLE IF EXISTS users; nested exception is org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: удалить объект таблица users нельзя, так как от него зависят другие объекты
  Подробности: ограничение meals_user_id_fkey в отношении таблица meals зависит от объекта таблица users
  Подсказка: Для удаления зависимых объектов используйте DROP ... CASCADE.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 48 common frames omitted
2016-08-11 18:29:46,626 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:29:46,644 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:29:46,646 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:29:46,777 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:29:46,987 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:29:47,153 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:29:47 MSK 2016]; root of context hierarchy
2016-08-11 18:29:47,310 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:29:47,528 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:29:47,549 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:29:47,589 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:29:47,816 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:29:47,817 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:29:47,820 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:29:47,884 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:29:48,264 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:29:48,468 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:29:48,478 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@4ef27d66
2016-08-11 18:29:48,911 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:29:49,393 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:29:49,709 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB.sql]
2016-08-11 18:29:49,716 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
2016-08-11 18:29:49,717 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:29:49,721 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@47b67fcb]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:30:35,710 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:30:35,731 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:30:35,733 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:30:35,878 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:30:36,091 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:30:36,195 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@5c5eefef]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.xml.XmlBeanDefinitionStoreException: Line 19 in XML document from class path resource [spring/spring-db.xml] is invalid; nested exception is org.xml.sax.SAXParseException; lineNumber: 19; columnNumber: 32; cvc-complex-type.2.4.b: The content of element 'jdbc:initialize-database' is not complete. One of '{"http://www.springframework.org/schema/jdbc":script}' is expected.
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:399)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:336)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:304)
	at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:181)
	at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:217)
	at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:188)
	at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:252)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadBeanDefinitions(AbstractGenericContextLoader.java:253)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:122)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.xml.sax.SAXParseException: cvc-complex-type.2.4.b: The content of element 'jdbc:initialize-database' is not complete. One of '{"http://www.springframework.org/schema/jdbc":script}' is expected.
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:203)
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(ErrorHandlerWrapper.java:134)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:396)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:327)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:284)
	at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator$XSIErrorReporter.reportError(XMLSchemaValidator.java:452)
	at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.reportSchemaError(XMLSchemaValidator.java:3230)
	at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.elementLocallyValidComplexType(XMLSchemaValidator.java:3206)
	at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.elementLocallyValidType(XMLSchemaValidator.java:3153)
	at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.processElementContent(XMLSchemaValidator.java:3055)
	at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.handleEndElement(XMLSchemaValidator.java:2134)
	at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.endElement(XMLSchemaValidator.java:853)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanEndElement(XMLDocumentFragmentScannerImpl.java:1783)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2970)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:606)
	at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:118)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:510)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:848)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:777)
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141)
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:243)
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:339)
	at org.springframework.beans.factory.xml.DefaultDocumentLoader.loadDocument(DefaultDocumentLoader.java:76)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadDocument(XmlBeanDefinitionReader.java:429)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:391)
	... 42 common frames omitted
2016-08-11 18:30:47,524 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:30:47,549 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:30:47,552 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:30:47,712 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:30:47,947 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:30:48,037 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:30:48 MSK 2016]; root of context hierarchy
2016-08-11 18:30:48,185 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:30:48,411 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:30:48,434 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:30:48,488 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:30:48,693 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:30:48,695 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:30:48,698 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:30:48,792 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:30:49,162 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:30:49,398 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:30:49,400 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@5f59185e
2016-08-11 18:30:49,880 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:30:50,333 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:30:50,708 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB.sql]
2016-08-11 18:30:50,721 WARN  TestContextManager [TestContextManager.java:268] Caught exception while allowing TestExecutionListener [org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70] to process 'before' execution of test method [public void mrigor87.votingsystem.service.RestaurantServiceImplTest.update() throws java.lang.Exception] for test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@47ffe971]
org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.execute(ResourceDatabasePopulator.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener$1.doInTransactionWithoutResult(SqlScriptsTestExecutionListener.java:252)
	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:34)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:143)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.beforeTestMethod(SqlScriptsTestExecutionListener.java:113)
	at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:265)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:254)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 35 common frames omitted
2016-08-11 18:30:50,733 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:30:48 MSK 2016]; root of context hierarchy
2016-08-11 18:30:50,734 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:31:38,122 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:31:38,146 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:31:38,147 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@64485a47, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@25bbf683, org.springframework.test.context.support.DirtiesContextTestExecutionListener@6ec8211c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@7276c8cd, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@544a2ea6]
2016-08-11 18:31:38,260 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:31:38,520 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:31:38,612 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@50de0926: startup date [Thu Aug 11 18:31:38 MSK 2016]; root of context hierarchy
2016-08-11 18:31:38,763 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:31:38,985 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:31:39,008 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:31:39,041 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:31:39,259 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:31:39,261 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:31:39,264 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:31:39,331 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:31:39,799 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:31:40,014 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:31:40,017 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@6d1d4d7
2016-08-11 18:31:40,465 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:31:40,924 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:31:41,202 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@50de0926: startup date [Thu Aug 11 18:31:38 MSK 2016]; root of context hierarchy
2016-08-11 18:31:41,205 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:32:04,471 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:32:04,493 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:32:04,497 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@64485a47, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@25bbf683, org.springframework.test.context.support.DirtiesContextTestExecutionListener@6ec8211c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@7276c8cd, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@544a2ea6]
2016-08-11 18:32:04,641 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:32:04,867 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:32:04,962 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@50de0926: startup date [Thu Aug 11 18:32:04 MSK 2016]; root of context hierarchy
2016-08-11 18:32:05,105 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:32:05,367 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:32:05,438 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:32:05,496 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:32:05,669 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:32:05,674 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:32:05,677 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:32:05,761 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:32:06,124 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:32:06,350 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:32:06,353 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@51e4ccb3
2016-08-11 18:32:06,799 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:32:07,253 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:32:07,539 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB.sql]
2016-08-11 18:32:07,545 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
2016-08-11 18:32:07,545 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:32:07,549 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@25bbf683] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@60859f5a]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:33:53,423 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:33:53,443 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:33:53,445 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@64485a47, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@25bbf683, org.springframework.test.context.support.DirtiesContextTestExecutionListener@6ec8211c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@7276c8cd, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@544a2ea6]
2016-08-11 18:33:53,565 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:33:53,802 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:33:53,900 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@50de0926: startup date [Thu Aug 11 18:33:53 MSK 2016]; root of context hierarchy
2016-08-11 18:33:54,052 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:33:54,378 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:33:54,415 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:33:54,450 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:33:54,582 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:33:54,585 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:33:54,589 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:33:54,678 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:33:55,097 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:33:55,316 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:33:55,319 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@51e4ccb3
2016-08-11 18:33:55,786 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:33:56,397 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:33:56,728 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB.sql]
2016-08-11 18:33:56,735 WARN  GenericApplicationContext [AbstractApplicationContext.java:546] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
2016-08-11 18:33:56,736 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:33:56,740 ERROR TestContextManager [TestContextManager.java:231] Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@25bbf683] to prepare test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@60859f5a]
java.lang.IllegalStateException: Failed to load ApplicationContext
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:83)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:117)
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:228)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:230)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:249)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.jdbc.datasource.init.DataSourceInitializer#0': Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1578)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:125)
	at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:60)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.delegateLoading(AbstractDelegatingSmartContextLoader.java:109)
	at org.springframework.test.context.support.AbstractDelegatingSmartContextLoader.loadContext(AbstractDelegatingSmartContextLoader.java:261)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:98)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:116)
	... 29 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.CompositeDatabasePopulator.populate(CompositeDatabasePopulator.java:60)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.execute(DataSourceInitializer.java:108)
	at org.springframework.jdbc.datasource.init.DataSourceInitializer.afterPropertiesSet(DataSourceInitializer.java:93)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1637)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1574)
	... 44 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 51 common frames omitted
2016-08-11 18:35:32,730 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:35:32,748 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:35:32,750 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:35:32,904 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:35:33,136 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:35:33,238 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:35:33 MSK 2016]; root of context hierarchy
2016-08-11 18:35:33,384 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:35:33,616 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:35:33,637 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:35:33,680 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:35:33,907 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:35:33,909 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:35:33,912 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:35:34,013 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:35:34,511 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:35:34,736 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:35:34,739 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@5f59185e
2016-08-11 18:35:35,206 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:35:35,673 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:35:36,023 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB.sql]
2016-08-11 18:35:36,041 WARN  TestContextManager [TestContextManager.java:268] Caught exception while allowing TestExecutionListener [org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70] to process 'before' execution of test method [public void mrigor87.votingsystem.service.RestaurantServiceImplTest.update() throws java.lang.Exception] for test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@47ffe971]
org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB.sql]: DELETE FROM restaurants; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.execute(ResourceDatabasePopulator.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener$1.doInTransactionWithoutResult(SqlScriptsTestExecutionListener.java:252)
	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:34)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:143)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.beforeTestMethod(SqlScriptsTestExecutionListener.java:113)
	at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:265)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:254)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 35 common frames omitted
2016-08-11 18:35:36,055 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:35:33 MSK 2016]; root of context hierarchy
2016-08-11 18:35:36,057 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:36:47,789 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:36:47,807 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:36:47,810 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:36:47,941 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:36:48,172 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:36:48,270 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:36:48 MSK 2016]; root of context hierarchy
2016-08-11 18:36:48,425 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:36:48,656 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:36:48,690 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:36:48,755 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:36:48,936 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:36:48,937 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:36:48,940 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:36:49,007 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:36:49,411 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:36:49,632 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:36:49,635 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@5f59185e
2016-08-11 18:36:50,097 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:36:50,563 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:36:50,918 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB0.sql]
2016-08-11 18:36:50,929 WARN  TestContextManager [TestContextManager.java:268] Caught exception while allowing TestExecutionListener [org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70] to process 'before' execution of test method [public void mrigor87.votingsystem.service.RestaurantServiceImplTest.update() throws java.lang.Exception] for test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@47ffe971]
org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB0.sql]: INSERT INTO restaurants(name) VALUES ('Restaurant1'), ('Restaurant2'), ('Restaurant3'); nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.execute(ResourceDatabasePopulator.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener$1.doInTransactionWithoutResult(SqlScriptsTestExecutionListener.java:252)
	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:34)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:143)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.beforeTestMethod(SqlScriptsTestExecutionListener.java:113)
	at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:265)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:254)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 35 common frames omitted
2016-08-11 18:36:50,941 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:36:48 MSK 2016]; root of context hierarchy
2016-08-11 18:36:50,943 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:37:11,486 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:37:11,510 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:37:11,512 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:37:11,676 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:37:11,878 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:37:11,984 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:37:11 MSK 2016]; root of context hierarchy
2016-08-11 18:37:12,121 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:37:12,472 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:37:12,505 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:37:12,543 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:37:12,715 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:37:12,717 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:37:12,720 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:37:12,785 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:37:13,147 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:37:13,367 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:37:13,370 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@5f59185e
2016-08-11 18:37:13,829 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:37:14,283 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:37:14,681 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB0.sql]
2016-08-11 18:37:14,691 WARN  TestContextManager [TestContextManager.java:268] Caught exception while allowing TestExecutionListener [org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70] to process 'before' execution of test method [public void mrigor87.votingsystem.service.RestaurantServiceImplTest.update() throws java.lang.Exception] for test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@47ffe971]
org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB0.sql]: INSERT INTO restaurants(name) VALUES ('Restaurant1'), ('Restaurant2'), ('Restaurant3'); nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.execute(ResourceDatabasePopulator.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener$1.doInTransactionWithoutResult(SqlScriptsTestExecutionListener.java:252)
	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:34)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:143)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.beforeTestMethod(SqlScriptsTestExecutionListener.java:113)
	at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:265)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:254)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 35 common frames omitted
2016-08-11 18:37:14,705 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:37:11 MSK 2016]; root of context hierarchy
2016-08-11 18:37:14,707 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:37:49,584 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:37:49,605 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:37:49,607 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:37:49,740 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:37:49,981 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:37:50,090 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:37:50 MSK 2016]; root of context hierarchy
2016-08-11 18:37:50,252 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:37:50,493 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:37:50,513 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:37:50,545 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:37:50,772 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:37:50,774 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:37:50,777 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:37:50,849 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:37:51,237 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:37:51,476 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:37:51,478 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@5f59185e
2016-08-11 18:37:51,940 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:37:52,377 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:37:52,713 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB0.sql]
2016-08-11 18:37:52,723 WARN  TestContextManager [TestContextManager.java:268] Caught exception while allowing TestExecutionListener [org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70] to process 'before' execution of test method [public void mrigor87.votingsystem.service.RestaurantServiceImplTest.update() throws java.lang.Exception] for test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@47ffe971]
org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB0.sql]: INSERT INTO restaurants(name) VALUES ('Restaurant1'), ('Restaurant2'), ('Restaurant3'); nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.execute(ResourceDatabasePopulator.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener$1.doInTransactionWithoutResult(SqlScriptsTestExecutionListener.java:252)
	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:34)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:143)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.beforeTestMethod(SqlScriptsTestExecutionListener.java:113)
	at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:265)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:254)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "restaurants" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 35 common frames omitted
2016-08-11 18:37:52,736 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:37:50 MSK 2016]; root of context hierarchy
2016-08-11 18:37:52,738 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:38:53,500 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:38:53,521 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:38:53,525 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:38:53,680 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:38:53,888 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:38:53,985 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:38:53 MSK 2016]; root of context hierarchy
2016-08-11 18:38:54,130 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:38:54,386 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:38:54,433 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:38:54,492 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:38:54,652 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:38:54,654 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:38:54,657 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:38:54,739 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:38:55,131 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:38:55,367 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:38:55,370 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@5f59185e
2016-08-11 18:38:55,830 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:38:56,276 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:38:56,646 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB0.sql]
2016-08-11 18:38:56,655 WARN  TestContextManager [TestContextManager.java:268] Caught exception while allowing TestExecutionListener [org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70] to process 'before' execution of test method [public void mrigor87.votingsystem.service.RestaurantServiceImplTest.update() throws java.lang.Exception] for test instance [mrigor87.votingsystem.service.RestaurantServiceImplTest@47ffe971]
org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of class path resource [db/populateDB0.sql]: DELETE FROM user_roles; nested exception is org.postgresql.util.PSQLException: ОШИБКА: отношение "user_roles" не существует
  Позиция: 13
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:494)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:231)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:48)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.execute(ResourceDatabasePopulator.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener$1.doInTransactionWithoutResult(SqlScriptsTestExecutionListener.java:252)
	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:34)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:248)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:143)
	at org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.beforeTestMethod(SqlScriptsTestExecutionListener.java:113)
	at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:265)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:254)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "user_roles" не существует
  Позиция: 13
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:473)
	... 35 common frames omitted
2016-08-11 18:38:56,668 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:38:53 MSK 2016]; root of context hierarchy
2016-08-11 18:38:56,669 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
2016-08-11 18:39:32,251 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:258] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2016-08-11 18:39:32,274 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:207] Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [org/springframework/web/context/request/RequestAttributes]
2016-08-11 18:39:32,277 INFO  DefaultTestContextBootstrapper [AbstractTestContextBootstrapper.java:185] Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@149494d8, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@710726a3, org.springframework.test.context.support.DirtiesContextTestExecutionListener@646007f4, org.springframework.test.context.transaction.TransactionalTestExecutionListener@481a15ff, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@78186a70]
2016-08-11 18:39:32,416 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-app.xml]
2016-08-11 18:39:32,653 INFO  XmlBeanDefinitionReader [XmlBeanDefinitionReader.java:317] Loading XML bean definitions from class path resource [spring/spring-db.xml]
2016-08-11 18:39:32,747 INFO  GenericApplicationContext [AbstractApplicationContext.java:578] Refreshing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:39:32 MSK 2016]; root of context hierarchy
2016-08-11 18:39:32,899 INFO  PropertyPlaceholderConfigurer [PropertiesLoaderSupport.java:172] Loading properties file from class path resource [db/postgres.properties]
2016-08-11 18:39:33,127 INFO  DriverManagerDataSource [DriverManagerDataSource.java:133] Loaded JDBC driver: org.postgresql.Driver
2016-08-11 18:39:33,161 INFO  LocalContainerEntityManagerFactoryBean [LocalContainerEntityManagerFactoryBean.java:339] Building JPA container EntityManagerFactory for persistence unit 'default'
2016-08-11 18:39:33,243 INFO  LogHelper [LogHelper.java:31] HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2016-08-11 18:39:33,450 INFO  Version [Version.java:37] HHH000412: Hibernate Core {5.1.0.Final}
2016-08-11 18:39:33,453 INFO  Environment [Environment.java:213] HHH000206: hibernate.properties not found
2016-08-11 18:39:33,456 INFO  Environment [Environment.java:317] HHH000021: Bytecode provider name : javassist
2016-08-11 18:39:33,551 INFO  Version [JavaReflectionManager.java:66] HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2016-08-11 18:39:33,952 INFO  Dialect [Dialect.java:156] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2016-08-11 18:39:34,186 INFO  LobCreatorBuilderImpl [LobCreatorBuilderImpl.java:124] HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2016-08-11 18:39:34,189 INFO  BasicTypeRegistry [BasicTypeRegistry.java:138] HHH000270: Type registration [java.util.UUID] overrides previous : org.hibernate.type.UUIDBinaryType@2b62442c
2016-08-11 18:39:34,663 INFO  Version [Version.java:30] HV000001: Hibernate Validator 5.2.4.Final
2016-08-11 18:39:35,106 INFO  QueryTranslatorFactoryInitiator [QueryTranslatorFactoryInitiator.java:47] HHH000397: Using ASTQueryTranslatorFactory
2016-08-11 18:39:35,452 INFO  ScriptUtils [ScriptUtils.java:444] Executing SQL script from class path resource [db/populateDB.sql]
2016-08-11 18:39:35,459 INFO  ScriptUtils [ScriptUtils.java:510] Executed SQL script from class path resource [db/populateDB.sql] in 7 ms.
2016-08-11 18:39:35,466 INFO  GenericApplicationContext [AbstractApplicationContext.java:960] Closing org.springframework.context.support.GenericApplicationContext@101df177: startup date [Thu Aug 11 18:39:32 MSK 2016]; root of context hierarchy
2016-08-11 18:39:35,466 INFO  LocalContainerEntityManagerFactoryBean [AbstractEntityManagerFactoryBean.java:481] Closing JPA EntityManagerFactory for persistence unit 'default'
